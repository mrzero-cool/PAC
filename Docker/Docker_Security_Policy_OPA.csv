Check ID,Check Name,File Type,Description,Severity,Risk,Enforcement Level
DF_BASE_001,Use specific base image version tag,Dockerfile,Always specify an explicit version tag for base images instead of using 'latest' tag to ensure reproducible builds and predictable behavior,Critical,"Using 'latest' tag can introduce breaking changes when base image is updated, potentially introducing vulnerabilities",DENY
DF_BASE_002,Use minimal/hardened base images,Dockerfile,"Prefer minimal base images (Alpine, Distroless, Chainguard) to reduce attack surface and image size",High,Bloated base images with unnecessary packages increase vulnerability exposure and deployment time,WARN
DF_BASE_003,Use trusted registry for base images,Dockerfile,"Only pull base images from trusted official registries (Docker Hub Official, trusted vendors)",Critical,Untrusted registries may contain compromised or malicious images leading to supply chain attacks,DENY
DF_BASE_004,Use base image digest instead of tag,Dockerfile,Pin base images by SHA256 digest for maximum reproducibility and security,High,"Tags can be modified or re-tagged, allowing tag substitution attacks; digest is immutable",WARN
DF_BASE_005,Verify base image is maintained and updated,Dockerfile,Choose base images that are actively maintained and regularly patched for security vulnerabilities,High,Unmaintained base images will accumulate unpatched vulnerabilities over time,WARN
DF_USER_001,Create and use non-root user,Dockerfile,"Create a non-root user for the application and ensure the container runs with this user, not root",Critical,Running as root allows attackers to easily gain full system access if container is compromised,DENY
DF_USER_002,Ensure final USER is not root,Dockerfile,The last USER instruction in Dockerfile must specify a non-root user to prevent privilege escalation,Critical,"Container will execute as root, enabling full host compromise if escape vulnerability is exploited",DENY
DF_USER_003,Remove SUID and SGID bits from files,Dockerfile,Remove setuid and setgid bits from files in the image to prevent privilege escalation,High,SUID/SGID binaries can be exploited by attackers to elevate privileges within container,WARN
DF_FILE_002,Explicitly COPY required files only,Dockerfile,Copy only necessary files to container instead of copying entire directory with COPY . .,Critical,"Copying all files may inadvertently include secrets, credentials, or development artifacts in production image",DENY
DF_FILE_003,Set appropriate file permissions,Dockerfile,"Set restrictive file permissions (chmod) on copied files, especially for sensitive config files",High,World-readable sensitive files can be accessed by any process in the container,WARN
DF_FILE_004,Avoid curl bashing and pipe commands,Dockerfile,Do not use patterns like 'curl | bash' or 'wget | sh' as they bypass verification and can execute malicious code,Critical,Pipe-based execution skips verification steps and can be intercepted to inject malicious commands,DENY
DF_SEC_001,Do not hardcode secrets in Dockerfile,Dockerfile,"Never hardcode API keys, passwords, tokens, or certificates in Dockerfile or ENV instructions",Critical,Secrets persist in image layers forever and are accessible to anyone with image access,DENY
DF_SEC_002,Do not pass secrets via build ARG,Dockerfile,Avoid using ARG for secrets as they persist in image layer metadata and build history,Critical,ARG values are visible in image history and can be extracted by attackers analyzing image layers,DENY
DF_SEC_003,Use Docker BuildKit secrets mount,Dockerfile,Use --secret flag with BuildKit to mount secrets during build without storing them in image,High,Secrets passed as ENV or ARG will be visible in final image and layer history,WARN
DF_SEC_004,Do not commit .env or secrets files,Dockerfile/.dockerignore,"Ensure .env, .aws, .ssh, and other secret files are listed in .dockerignore to prevent inclusion in build",Critical,Secret files accidentally copied into image expose credentials to anyone with image access,DENY
DF_PKG_002,Pin package versions explicitly,Dockerfile,Specify exact package versions (name=version) instead of allowing automatic version selection,High,Automatic version selection can introduce breaking changes or install known vulnerable versions,WARN
DF_PKG_006,Remove unnecessary packages,Dockerfile,Only install packages required for application runtime; remove development tools from production images,High,Unnecessary packages increase attack surface and may contain exploitable vulnerabilities,WARN
DF_CMD_002,Use exec form not shell form,Dockerfile,Use exec form (JSON array syntax) for ENTRYPOINT and CMD to avoid shell processing,High,Shell form processes variables and enables shell injection attacks through environment variables,DENY
DF_CMD_003,Do not use sudo in container,Dockerfile,Never use sudo in RUN instructions; run commands directly as the appropriate user,High,Sudo in containers is unnecessary complexity and creates unnecessary attack surface,WARN
DF_CMD_004,Minimize running as root,Dockerfile,Only run commands that absolutely require root with root; switch to non-root user for application,High,Unnecessarily running as root increases blast radius if container is compromised,WARN
DF_FS_003,Set appropriate WORKDIR ownership,Dockerfile,Ensure WORKDIR is owned by non-root user running the application,High,"If WORKDIR is owned by root, non-root user cannot write to it, breaking application",WARN
DF_MULTI_001,Use multistage builds to reduce final size,Dockerfile,Use multistage builds to separate build environment from runtime; copy only artifacts to final stage,Medium,Single-stage builds include unnecessary build tools and dependencies in production image,WARN
DF_MULTI_003,Copy only necessary artifacts between stages,Dockerfile,"In multistage builds, explicitly COPY only required artifacts, not entire directories",High,"Copying entire directories may include build artifacts, development files, or secrets",WARN
DF_BUILD_003,Use .dockerignore to exclude files,.dockerignore,"Create .dockerignore to exclude unnecessary files (.git, node_modules, .env) from build context",Medium,Including unnecessary files increases build context size and may expose secrets,WARN
DF_HEALTH_001,Include HEALTHCHECK instruction,Dockerfile,"Define HEALTHCHECK with appropriate interval, timeout, and start period for application health monitoring",Medium,"Without healthcheck, container orchestrators cannot detect unhealthy instances and may serve bad requests",MEDIUM
DC_IMG_001,Use specific image version tags,docker-compose.yml,"Always specify explicit image version tags (e.g., myapp:1.0.0) instead of 'latest' or no tag",Critical,"Without explicit tags, composition may use different image versions causing unpredictable behavior",DENY
DC_IMG_002,Use image pull policy Always for base images,docker-compose.yml,Ensure images are pulled from registry each time (image_pull_policy: always) for latest updates,High,Stale cached images may have known vulnerabilities,WARN
DC_USER_001,Run services as non-root user,docker-compose.yml,"Set 'user: UID:GID' (e.g., user: 1000:1000) to run service as non-root user",Critical,Services running as root allow full system compromise if container is exploited,DENY
DC_USER_002,Do not use privileged mode,docker-compose.yml,Never set 'privileged: true' as it grants full host access; use capabilities instead,Critical,"Privileged containers disable all isolation features, allowing complete host compromise",DENY
DC_SEC_001,Disable privilege escalation,docker-compose.yml,Set 'security_opt: [no-new-privileges:true]' to prevent processes gaining new privileges,High,"Without no-new-privileges, exploits can escalate from current user to root or other users",DENY
DC_SEC_002,Drop all unnecessary capabilities,docker-compose.yml,Always drop all capabilities with 'cap_drop: [ALL]' and add back only required ones,Critical,Unnecessary Linux capabilities allow privilege escalation and unauthorized system access,DENY
DC_SEC_003,Only add required capabilities,docker-compose.yml,"Use 'cap_add' to add back only specific capabilities needed (e.g., NET_BIND_SERVICE, CHOWN)",Critical,Added capabilities expand attack surface; only essential capabilities should be granted,WARN
DC_SEC_004,Set read-only root filesystem,docker-compose.yml,Set 'read_only: true' to prevent modifications to root filesystem; use 'tmpfs' for writable dirs,High,Writable filesystem allows attackers to modify system files and persist backdoors,WARN
DC_SEC_005,Use tmpfs for temporary files,docker-compose.yml,"Mount '/tmp' and '/run' as tmpfs with noexec,nosuid,nodev flags when read_only is true",High,"Without tmpfs, application cannot write temporary files; with wrong flags, can execute malicious code",WARN
DC_NET_001,Define services on custom network,docker-compose.yml,Define all services on custom 'networks' instead of using default bridge network,High,Default network allows all containers to communicate; custom networks enforce service isolation,WARN
DC_NET_002,Do not expose unnecessary ports,docker-compose.yml,Only expose ports that are required for external access; avoid exposing debug or management ports,High,Exposed ports increase attack surface and may allow unauthorized access to services,WARN
DC_NET_004,Do not expose port 22 (SSH),docker-compose.yml,Never expose port 22; use 'docker-compose exec' for container access,High,Exposed SSH port allows unauthorized remote access to containers,DENY
DC_NET_005,Use network_mode carefully,docker-compose.yml,Avoid 'network_mode: host' which disables network isolation; only use bridge (default),Critical,Host network mode disables network isolation allowing direct access to host network,DENY
DC_VOL_001,Mount volumes with appropriate flags,docker-compose.yml,"Use volume mount flags (ro, rw, Z, z) appropriately; use ':ro' for read-only when possible",High,World-writable volumes allow unauthorized data modification and potential privilege escalation,WARN
DC_VOL_002,Avoid mounting host directories with write access,docker-compose.yml,Do not mount host directories with write access (rw flag); use read-only (:ro) when possible,Critical,Write access to host filesystem allows attackers to modify or delete host files,DENY
DC_VOL_003,Do not mount Docker socket,docker-compose.yml,Never mount '/var/run/docker.sock' in container as it grants full Docker daemon access,Critical,Docker socket access allows container to manage all containers and access host directly,DENY
DC_VOL_004,Do not mount host filesystem root,docker-compose.yml,Never mount '/' (host root) into container as it allows complete host compromise,Critical,Root filesystem mount allows attackers to modify host system and persist attacks,DENY
DC_VOL_006,Set volume ownership to non-root,docker-compose.yml,Ensure volumes are owned by non-root user running application to prevent permission issues,High,"Root-owned volumes prevent non-root users from writing data, breaking application",WARN
DC_VOL_007,Use tmpfs for temporary storage,docker-compose.yml,"Mount tmpfs volumes for temporary files with restrictions: tmpfs: options: [noexec, nosuid, nodev]",High,Writable tmpfs without restrictions allows execution of malicious code in memory,WARN
DC_ENV_001,Do not use environment variables for secrets,docker-compose.yml,"Never store passwords, tokens, API keys in 'environment' section; use external secret management",Critical,"Environment variables are visible in process list, container inspect, and logs",DENY
DC_ENV_002,Use .env file for non-secret configuration,.env,Use .env file for non-secret configuration; add .env to .gitignore to prevent accidental commits,High,Hardcoded configuration makes composition inflexible and may expose sensitive defaults,WARN
DC_ENV_003,Do not commit .env files to version control,.gitignore,"Add .env, .env.local, .env.*.local to .gitignore to prevent committing configuration files",Critical,Committed .env files expose all configuration including secrets to repository access,DENY
DC_SEC_MAN_001,Use Docker Secrets for sensitive data,docker-compose.yml,Use 'secrets' section with external secret file for sensitive data in Swarm mode,High,"Without secrets, configuration exposes sensitive data to multiple exposure points",WARN
DC_HEALTH_001,Define health checks for all services,docker-compose.yml,"Include 'healthcheck' for each service with test, interval, timeout, and retries",Medium,"Without healthchecks, failed services continue running and serving bad requests",MEDIUM
DC_LOG_001,Configure logging driver,docker-compose.yml,"Set 'logging: driver' and 'logging: options' for centralized logging (json-file, syslog, splunk)",High,"Without logging configuration, logs are not collected for audit and forensics",WARN
DC_LOG_002,Set log rotation and size limits,docker-compose.yml,Configure 'max-size' and 'max-file' for log rotation to prevent disk space exhaustion,High,Unlimited log size can fill disk and cause service failure,WARN
DC_LOG_003,Do not log sensitive information,docker-compose.yml,"Ensure application does not log passwords, tokens, or sensitive data in logs",Critical,Logged secrets are visible in logs and centralized logging systems,DENY
GEN_YAML_001,Valid YAML syntax,docker-compose.yml,Ensure docker-compose.yml has valid YAML syntax with proper indentation and quoting,Critical,Invalid YAML causes parsing errors and prevents service startup,DENY
GEN_JSON_001,Valid JSON syntax for daemon.json,daemon.json,"Ensure daemon.json is valid JSON with proper syntax, comma placement, and quoting",Critical,Invalid JSON prevents daemon from starting,DENY
